-- Load Fluent
local ok, Fluent = pcall(function()
    return loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
end)
if not ok or not Fluent then
    warn("Failed to load Fluent library. Aborting UI creation.")
    return
end

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local humanoid = char:WaitForChild("Humanoid")
local hrp = char:WaitForChild("HumanoidRootPart")
local uis = game:GetService("UserInputService")
local runService = game:GetService("RunService")

-- Settings
local positions = { Vector3.new(-1863.68, -50.96, 295.65) }
local interval = 18
local index = 1
local running = false
local timeLeft = interval

-- Create Fluent Window & Tabs
local Window = Fluent:CreateWindow({
    Title = "Auto Win",
    SubTitle = "Script Automation",
    TabWidth = 160,
    Size = UDim2.fromOffset(480, 500),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.RightControl
})
local Tabs = { Main = Window:AddTab({ Title = "Main", Icon = "home" }) }

-- WalkSpeed Slider
local SpeedSlider = Tabs.Main:AddSlider("WalkSpeed", {
    Title = "WalkSpeed",
    Min = 8,
    Max = 400,
    Default = humanoid.WalkSpeed,
    Rounding = 0
})

-- JumpPower Slider
local JumpPowerSlider = Tabs.Main:AddSlider("JumpPower", {
    Title = "Jump Power",
    Min = 50,
    Max = 500,
    Default = humanoid.JumpPower,
    Rounding = 0
})

-- Auto Teleport Toggle
local AutoTeleportToggle = Tabs.Main:AddToggle("AutoTeleport", {
    Title = "Auto Teleport",
    Default = false
})

-- Flight Toggle + Speed Slider
local FlyToggle = Tabs.Main:AddToggle("Fly", {
    Title = "Flight",
    Default = false
})

local FlySpeedSlider = Tabs.Main:AddSlider("FlySpeed", {
    Title = "Flight Speed",
    Min = 10,
    Max = 400,
    Default = 50,
    Rounding = 0
})

-- Infinite Jump Toggle
local InfiniteJumpToggle = Tabs.Main:AddToggle("InfiniteJump", {
    Title = "Infinite Jump",
    Default = false
})

-- Noclip Toggle
local NoclipToggle = Tabs.Main:AddToggle("Noclip", {
    Title = "Noclip",
    Default = false
})

-- Status GUI
local playerGui = player:WaitForChild("PlayerGui")
local statusGui = Instance.new("ScreenGui")
statusGui.Name = "AutoWinStatusGui"
statusGui.ResetOnSpawn = false
statusGui.Parent = playerGui

local statusFrame = Instance.new("Frame")
statusFrame.Size = UDim2.new(0, 220, 0, 92)
statusFrame.Position = UDim2.new(0.5, 260, 0.5, -170)
statusFrame.AnchorPoint = Vector2.new(0, 0)
statusFrame.BackgroundTransparency = 0.12
statusFrame.BackgroundColor3 = Color3.fromRGB(20,20,20)
statusFrame.BorderSizePixel = 0
statusFrame.Parent = statusGui
Instance.new("UICorner", statusFrame).CornerRadius = UDim.new(0, 8)

local titleLabel = Instance.new("TextLabel")
titleLabel.Parent = statusFrame
titleLabel.Size = UDim2.new(1, -12, 0, 24)
titleLabel.Position = UDim2.new(0, 6, 0, 6)
titleLabel.BackgroundTransparency = 1
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 16
titleLabel.TextColor3 = Color3.fromRGB(255,255,255)
titleLabel.Text = "Auto Win Status"

local statusLabel = Instance.new("TextLabel")
statusLabel.Parent = statusFrame
statusLabel.Size = UDim2.new(1, -12, 0, 20)
statusLabel.Position = UDim2.new(0, 6, 0, 30)
statusLabel.BackgroundTransparency = 1
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 14
statusLabel.TextColor3 = Color3.fromRGB(255,80,80)
statusLabel.Text = "Status: OFF"

local timerLabel = Instance.new("TextLabel")
timerLabel.Parent = statusFrame
timerLabel.Size = UDim2.new(1, -12, 0, 12)
timerLabel.Position = UDim2.new(0, 6, 0, 52)
timerLabel.BackgroundTransparency = 1
timerLabel.Font = Enum.Font.Gotham
timerLabel.TextSize = 13
timerLabel.TextColor3 = Color3.fromRGB(180,180,255)
timerLabel.Text = "Next teleport in: --"

-- Make statusFrame draggable
local dragging = false
local dragInput, mousePos, framePos
local function update(input)
    local delta = input.Position - mousePos
    statusFrame.Position = UDim2.new(
        0, framePos.X + delta.X,
        0, framePos.Y + delta.Y
    )
end
statusFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        mousePos = input.Position
        framePos = Vector2.new(statusFrame.Position.X.Offset, statusFrame.Position.Y.Offset)
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)
statusFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)
uis.InputChanged:Connect(function(input)
    if input == dragInput and dragging then update(input) end
end)

-- WalkSpeed and JumpPower
SpeedSlider:OnChanged(function(value)
    if humanoid then humanoid.WalkSpeed = value end
end)

JumpPowerSlider:OnChanged(function(value)
    if humanoid then humanoid.JumpPower = value end
end)

-- Noclip loop
runService.Stepped:Connect(function()
    if NoclipToggle.Value then
        for _, part in pairs(char:GetDescendants()) do
            if part:IsA("BasePart") then part.CanCollide = false end
        end
    else
        for _, part in pairs(char:GetDescendants()) do
            if part:IsA("BasePart") then part.CanCollide = true end
        end
    end
end)

-- Auto Teleport loop
local function teleportLoop()
    task.spawn(function()
        while running do
            timeLeft = interval
            while timeLeft > 0 and running do
                timerLabel.Text = "Next teleport in: " .. tostring(timeLeft) .. "s"
                task.wait(1)
                timeLeft = timeLeft - 1
            end
            if running then
                local curHrp = char:FindFirstChild("HumanoidRootPart")
                if curHrp then
                    curHrp.CFrame = CFrame.new(positions[index])
                end
                index = index + 1
                if index > #positions then index = 1 end
            end
        end
        timerLabel.Text = "Next teleport in: --"
    end)
end

AutoTeleportToggle:OnChanged(function(value)
    running = value
    if running then
        statusLabel.Text = "Status: ON"
        statusLabel.TextColor3 = Color3.fromRGB(80,255,80)
        teleportLoop()
    else
        statusLabel.Text = "Status: OFF"
        statusLabel.TextColor3 = Color3.fromRGB(255,80,80)
        timerLabel.Text = "Next teleport in: --"
    end
end)

-- Flight logic (desktop + mobile support)
local flying = false
local bv, bg, flyUpButton, flyDownButton

FlyToggle:OnChanged(function(value)
    flying = value
    local hrpNow = char:FindFirstChild("HumanoidRootPart")
    if not hrpNow then return end
    local cam = workspace.CurrentCamera

    -- Mobile buttons
    if uis.TouchEnabled then
        flyUpButton = Instance.new("TextButton")
        flyUpButton.Size = UDim2.new(0,60,0,60)
        flyUpButton.Position = UDim2.new(0,20,1,-140)
        flyUpButton.Text = "Up"
        flyUpButton.BackgroundColor3 = Color3.fromRGB(30,30,30)
        flyUpButton.TextColor3 = Color3.new(1,1,1)
        flyUpButton.Parent = playerGui

        flyDownButton = Instance.new("TextButton")
        flyDownButton.Size = UDim2.new(0,60,0,60)
        flyDownButton.Position = UDim2.new(0,100,1,-140)
        flyDownButton.Text = "Down"
        flyDownButton.BackgroundColor3 = Color3.fromRGB(30,30,30)
        flyDownButton.TextColor3 = Color3.new(1,1,1)
        flyDownButton.Parent = playerGui
    end

    if flying then
        bv = Instance.new("BodyVelocity")
        bv.MaxForce = Vector3.new(1e5,1e5,1e5)
        bv.Velocity = Vector3.zero
        bv.Parent = hrpNow

        bg = Instance.new("BodyGyro")
        bg.MaxTorque = Vector3.new(1e5,1e5,1e5)
        bg.CFrame = hrpNow.CFrame
        bg.Parent = hrpNow

        task.spawn(function()
            while flying and hrpNow.Parent do
                local dir = Vector3.zero
                if not uis.TouchEnabled then
                    if uis:IsKeyDown(Enum.KeyCode.W) then dir += hrpNow.CFrame.LookVector end
                    if uis:IsKeyDown(Enum.KeyCode.S) then dir -= hrpNow.CFrame.LookVector end
                    if uis:IsKeyDown(Enum.KeyCode.A) then dir -= hrpNow.CFrame.RightVector end
                    if uis:IsKeyDown(Enum.KeyCode.D) then dir += hrpNow.CFrame.RightVector end
                    if uis:IsKeyDown(Enum.KeyCode.Space) then dir += Vector3.new(0,1,0) end
                    if uis:IsKeyDown(Enum.KeyCode.LeftShift) then dir -= Vector3.new(0,1,0) end
                else
                    if flyUpButton and flyUpButton:IsPressed() then dir += Vector3.new(0,1,0) end
                    if flyDownButton and flyDownButton:IsPressed() then dir -= Vector3.new(0,1,0) end
                end
                if dir.Magnitude > 0 then
                    bv.Velocity = bv.Velocity:Lerp(dir.Unit * FlySpeedSlider.Value, 0.2)
                else
                    bv.Velocity = bv.Velocity:Lerp(Vector3.zero, 0.2)
                end
                task.wait()
            end
        end)
    else
        if bv then bv:Destroy() end
        if bg then bg:Destroy() end
        if flyUpButton then flyUpButton:Destroy() end
        if flyDownButton then flyDownButton:Destroy() end
    end
end)

-- Infinite Jump with JumpPower support
InfiniteJumpToggle:OnChanged(function(value)
    if InfiniteJumpToggle._conn then
        InfiniteJumpToggle._conn:Disconnect()
    end
    if value then
        InfiniteJumpToggle._conn = uis.JumpRequest:Connect(function()
            if humanoid then
                humanoid.JumpPower = JumpPowerSlider.Value
                humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end)
    end
end)

-- Keep GUI in sync across respawns
player.CharacterAdded:Connect(function(c)
    char = c
    humanoid = c:WaitForChild("Humanoid")
    hrp = c:WaitForChild("HumanoidRootPart")
    humanoid.WalkSpeed = SpeedSlider.Value
    humanoid.JumpPower = JumpPowerSlider.Value
end)

print("Fluent Auto Win UI (JumpPower + Infinite Jump + Noclip + Flight + AutoTeleport) loaded")
