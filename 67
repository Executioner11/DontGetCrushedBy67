-- Load Fluent
local ok, Fluent = pcall(function()
    return loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
end)
if not ok or not Fluent then
    warn("Failed to load Fluent library. Aborting UI creation.")
    return
end

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local humanoid = char:WaitForChild("Humanoid")
local hrp = char:WaitForChild("HumanoidRootPart")
local uis = game:GetService("UserInputService")

-- Settings
local positions = { Vector3.new(-1863.68, -50.96, 295.65) }
local interval = 18
local index = 1
local running = false
local timeLeft = interval

-- Create Fluent Window & Tabs
local Window = Fluent:CreateWindow({
    Title = "Auto Win",
    SubTitle = "Script Automation",
    TabWidth = 160,
    Size = UDim2.fromOffset(480, 440),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.RightControl
})
local Tabs = { Main = Window:AddTab({ Title = "Main", Icon = "home" }) }

-- Add Fluent controls
local SpeedSlider = Tabs.Main:AddSlider("WalkSpeed", {
    Title = "WalkSpeed",
    Min = 8,
    Max = 400,
    Default = humanoid.WalkSpeed,
    Rounding = 0
})

local AutoTeleportToggle = Tabs.Main:AddToggle("AutoTeleport", {
    Title = "Auto Teleport",
    Default = false
})

local FlyToggle = Tabs.Main:AddToggle("Fly", {
    Title = "Flight",
    Default = false
})

local FlySpeedSlider = Tabs.Main:AddSlider("FlySpeed", {
    Title = "Flight Speed",
    Min = 10,
    Max = 400,
    Default = 50,
    Rounding = 0
})

local InfiniteJumpToggle = Tabs.Main:AddToggle("InfiniteJump", {
    Title = "Infinite Jump",
    Default = false
})

-- Status GUI
local playerGui = player:WaitForChild("PlayerGui")
local statusGui = Instance.new("ScreenGui")
statusGui.Name = "AutoWinStatusGui"
statusGui.ResetOnSpawn = false
statusGui.Parent = playerGui

local statusFrame = Instance.new("Frame")
statusFrame.Size = UDim2.new(0, 220, 0, 72)
statusFrame.Position = UDim2.new(0.5, 260, 0.5, -170)
statusFrame.AnchorPoint = Vector2.new(0, 0)
statusFrame.BackgroundTransparency = 0.12
statusFrame.BackgroundColor3 = Color3.fromRGB(20,20,20)
statusFrame.BorderSizePixel = 0
statusFrame.Parent = statusGui
Instance.new("UICorner", statusFrame).CornerRadius = UDim.new(0, 8)

local titleLabel = Instance.new("TextLabel")
titleLabel.Parent = statusFrame
titleLabel.Size = UDim2.new(1, -12, 0, 24)
titleLabel.Position = UDim2.new(0, 6, 0, 6)
titleLabel.BackgroundTransparency = 1
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 16
titleLabel.TextColor3 = Color3.fromRGB(255,255,255)
titleLabel.Text = "Auto Win Status"

local statusLabel = Instance.new("TextLabel")
statusLabel.Parent = statusFrame
statusLabel.Size = UDim2.new(1, -12, 0, 20)
statusLabel.Position = UDim2.new(0, 6, 0, 30)
statusLabel.BackgroundTransparency = 1
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 14
statusLabel.TextColor3 = Color3.fromRGB(255,80,80)
statusLabel.Text = "Status: OFF"

local timerLabel = Instance.new("TextLabel")
timerLabel.Parent = statusFrame
timerLabel.Size = UDim2.new(1, -12, 0, 12)
timerLabel.Position = UDim2.new(0, 6, 0, 52)
timerLabel.BackgroundTransparency = 1
timerLabel.Font = Enum.Font.Gotham
timerLabel.TextSize = 13
timerLabel.TextColor3 = Color3.fromRGB(180,180,255)
timerLabel.Text = "Next teleport in: --"

-- Make statusFrame draggable
local dragging = false
local dragInput, mousePos, framePos

local function update(input)
    local delta = input.Position - mousePos
    statusFrame.Position = UDim2.new(
        0, framePos.X + delta.X,
        0, framePos.Y + delta.Y
    )
end

statusFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        mousePos = input.Position
        framePos = Vector2.new(statusFrame.Position.X.Offset, statusFrame.Position.Y.Offset)
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

statusFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

uis.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- WalkSpeed slider
SpeedSlider:OnChanged(function(value)
    local charNow = player.Character
    if charNow then
        local hum = charNow:FindFirstChildOfClass("Humanoid")
        if hum then hum.WalkSpeed = value end
    end
end)

-- Auto Teleport loop
local function teleportLoop()
    task.spawn(function()
        while running do
            timeLeft = interval
            while timeLeft > 0 and running do
                timerLabel.Text = "Next teleport in: " .. tostring(timeLeft) .. "s"
                task.wait(1)
                timeLeft = timeLeft - 1
            end

            if running then
                local curChar = player.Character
                local curHrp = curChar and curChar:FindFirstChild("HumanoidRootPart")
                if curHrp then
                    curHrp.CFrame = CFrame.new(positions[index])
                end

                index = index + 1
                if index > #positions then index = 1 end
            end
        end
        timerLabel.Text = "Next teleport in: --"
    end)
end

AutoTeleportToggle:OnChanged(function(value)
    running = value
    if running then
        statusLabel.Text = "Status: ON"
        statusLabel.TextColor3 = Color3.fromRGB(80,255,80)
        teleportLoop()
    else
        statusLabel.Text = "Status: OFF"
        statusLabel.TextColor3 = Color3.fromRGB(255,80,80)
        timerLabel.Text = "Next teleport in: --"
    end
end)

-- Flight logic with full mobile support
local flying = false
local bv, bg
local flyUpButton, flyDownButton

FlyToggle:OnChanged(function(value)
    flying = value
    local charNow = player.Character
    if not charNow then return end
    local hrpNow = charNow:FindFirstChild("HumanoidRootPart")
    if not hrpNow then return end
    local cam = workspace.CurrentCamera

    -- Mobile buttons
    if uis.TouchEnabled then
        flyUpButton = Instance.new("TextButton")
        flyUpButton.Size = UDim2.new(0,60,0,60)
        flyUpButton.Position = UDim2.new(0,20,1,-140)
        flyUpButton.Text = "Up"
        flyUpButton.BackgroundColor3 = Color3.fromRGB(30,30,30)
        flyUpButton.TextColor3 = Color3.new(1,1,1)
        flyUpButton.Parent = playerGui

        flyDownButton = Instance.new("TextButton")
        flyDownButton.Size = UDim2.new(0,60,0,60)
        flyDownButton.Position = UDim2.new(0,100,1,-140)
        flyDownButton.Text = "Down"
        flyDownButton.BackgroundColor3 = Color3.fromRGB(30,30,30)
        flyDownButton.TextColor3 = Color3.new(1,1,1)
        flyDownButton.Parent = playerGui
    end

    if flying then
        bv = Instance.new("BodyVelocity")
        bv.MaxForce = Vector3.new(1e5,1e5,1e5)
        bv.Velocity = Vector3.new(0,0,0)
        bv.Parent = hrpNow

        bg = Instance.new("BodyGyro")
        bg.MaxTorque = Vector3.new(1e5,1e5,1e5)
        bg.CFrame = hrpNow.CFrame
        bg.Parent = hrpNow

        task.spawn(function()
            while flying and hrpNow.Parent do
                local dir = Vector3.zero
                -- Desktop movement
                if not uis.TouchEnabled then
                    if uis:IsKeyDown(Enum.KeyCode.W) then dir = dir + hrpNow.CFrame.LookVector end
                    if uis:IsKeyDown(Enum.KeyCode.S) then dir = dir - hrpNow.CFrame.LookVector end
                    if uis:IsKeyDown(Enum.KeyCode.A) then dir = dir - hrpNow.CFrame.RightVector end
                    if uis:IsKeyDown(Enum.KeyCode.D) then dir = dir + hrpNow.CFrame.RightVector end
                    if uis:IsKeyDown(Enum.KeyCode.Space) then dir = dir + Vector3.new(0,1,0) end
                    if uis:IsKeyDown(Enum.KeyCode.LeftShift) then dir = dir - Vector3.new(0,1,0) end
                else
                    -- Mobile movement: camera direction + buttons
                    local camForward = cam.CFrame.LookVector
                    local camRight = cam.CFrame.RightVector
                    -- virtual buttons are Up/Down for vertical only
                    if flyUpButton and flyUpButton:IsDescendantOf(playerGui) and flyUpButton:IsPressed() then
                        dir = dir + Vector3.new(0,1,0)
                    end
                    if flyDownButton and flyDownButton:IsDescendantOf(playerGui) and flyDownButton:IsPressed() then
                        dir = dir - Vector3.new(0,1,0)
                    end
                    -- Optional: touch joystick movement integration here
                end

                if dir.Magnitude > 0 then
                    bv.Velocity = bv.Velocity:Lerp(dir.Unit * FlySpeedSlider.Value, 0.2)
                else
                    bv.Velocity = bv.Velocity:Lerp(Vector3.zero, 0.2)
                end

                task.wait()
            end
        end)
    else
        if bv then bv:Destroy() end
        if bg then bg:Destroy() end
        if flyUpButton then flyUpButton:Destroy() end
        if flyDownButton then flyDownButton:Destroy() end
    end
end)

-- Infinite Jump
InfiniteJumpToggle:OnChanged(function(value)
    uis.JumpRequest:Connect(function()
        if value then
            local charNow = player.Character
            if charNow then
                local hum = charNow:FindFirstChildOfClass("Humanoid")
                if hum then
                    hum:ChangeState(Enum.HumanoidStateType.Jumping)
                end
            end
        end
    end)
end)

-- Keep GUI in sync across respawns
player.CharacterAdded:Connect(function(c)
    char = c
    humanoid = c:WaitForChild("Humanoid")
    hrp = c:WaitForChild("HumanoidRootPart")
    local speedVal = SpeedSlider and SpeedSlider.Value or humanoid.WalkSpeed
    if humanoid then humanoid.WalkSpeed = speedVal end
end)

print("Fluent Auto Win UI (full mobile + smooth flight + infinite jump) loaded")
